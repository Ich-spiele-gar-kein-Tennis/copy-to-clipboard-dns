<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Copy to Clipboard</title>
    <script>
      window.onload = async function(){
        const url = new URL(window.location.href)
        var bodyText
        var success = false

        if(url.searchParams.has("copy")){
          const text = url.searchParams.get("copy")
          bodyText = "Copied text \"" + text + "\" to the clipboard."
          try {
            if (!navigator.clipboard || !navigator.clipboard.writeText) {
              throw new Error("Clipboard API unavailable")
            }
            await navigator.clipboard.writeText(text)
            success = true
          } catch (e) {
            bodyText = "Failed to set text to clipboard. Copy it manually: " + text
          }
        } else {
          bodyText = "No \"copy\" parameter applied to URL."
        }
        
        const textnode = document.createTextNode(bodyText);
        document.body.appendChild(textnode);

        if(success){
          window.setTimeout(function(){
            window.close()
          }, 500)
        }
      }
    </script>
  </head>
  <body>
    
  </body>
</html>
